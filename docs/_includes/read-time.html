<!-- Override theme's read-time include to be compatible with GitHub Pages (Liquid < 5).
     The upstream include uses `number_of_words: 'auto'`, which is unsupported in
     the GitHub Pages environment and causes: wrong number of arguments (given 2, expected 1).
-->

{% assign _content = include.content | default: page.content %}
{% assign words = _content | strip_html | number_of_words %}

{% assign wpm = 180 %}
{% assign min_time = 1 %}

{% assign read_time = words | divided_by: wpm %}
{% unless read_time > 0 %}
  {% assign read_time = min_time %}
{% endunless %}

{% assign loc_lang = include.lang | default: page.lang | default: site.lang | default: 'en' %}

{% capture read_prompt %}
  {{- site.data.locales[loc_lang].post.read_time.prompt -}}
{% endcapture %}

<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="{{ words }} {{ site.data.locales[loc_lang].post.words }}"
>
  <em>
    {{- read_time -}}
    {{ ' ' }}
    {{- site.data.locales[loc_lang].post.read_time.unit -}}
  </em>
  {%- if include.prompt -%}
    {%- assign _prompt_words = read_prompt | strip_html | number_of_words -%}
    {%- unless _prompt_words > 1 -%}{{ ' ' }}{%- endunless -%}
    {{ read_prompt }}
  {%- endif -%}
</span>

